% !TEX root = ../thesis-example.tex
%
\chapter{From mobility patterns to scaling}
\label{chap:scaling_model}

\begin{flushright}{\slshape    
I remember my friend Johnny von Neumann used to say,\\
`with four parameters I can fit an elephant\\
and with five I can make him wiggle his trunk'} \\ \medskip
--- Enrico Fermi (quoted in~\cite{Dyson:2004})
\end{flushright}

\bigskip

A common trait shared by all complex systems -- including cities -- is the
existence of a large variety of processes occuring over a wide range of time and
spatial scales. The main obstacle to the understanding of these systems
therefore resides in uncovering the hierarchy of processes and in singling out
the few ones which govern their dynamics. Albeit difficult, the hierarchisation
of processes is of prime importance. A failure to do so leads to models which
are  either too complex to give any real insight into the phenomenon, or too
simple and abstract to have any resemblance with reality. As a matter of fact,
despite numerous
attempts~\cite{Fujita:1982,Makse:1995,Batty:2008,Frasco:2014,Bettencourt:2010,Bettencourt:2013},
a theoretical understanding of many observed empirical regularities in cities is
still missing.\\

Here we show that the spatial structure of the mobility pattern
controls the scaling behaviour of many quantities in urban systems. Indeed, cities are
not only defined by the spatial organisation of places fulfilling different
functions -- shops, places of residence, workplaces, etc. -- but also by the way
indivduals move among them. Understanding where people live, where and how they
travel within the city thus appears as a necessary step towards a scientific
theory of cities.\\ 



\section{A naive approach}
\label{sec:elementary_understanding_of_the_scaling_relationships}

We start by presenting some naive arguments to estimate the scaling exponents
for the area $A$, the total daily distance driven $L_{tot}$ and the total lane
miles $L_N$. Although these predictions turn out to be wrong, naive scalings are
useful as a first approach to the problem as they allow us understand how the
different quantities relate to one another.

\subsection{Surface area}

We first would like to estimate the dependence of the area
$A$ of a city on its population $P$ -- a long standing problem in the
field~\cite{Stewart:1947, Batty:2011}.

\paragraph{Naive argument.}  A first crude approach is to assume
that cities evolve in such a way that their population density $\rho = P/A$
remains constant. This assumption immediately implies that the area should
scale linearly with population
%
\begin{equation} 
    A \sim \lambda^2\, P 
    \label{eq:area_naive} 
\end{equation}

where $\lambda^2$ is the average surface occupied by each individual (the
assumption of a constant density is then equivalent to the one of a constant
average surface per capita).

\paragraph{Reality.} The naive argument does not compare well with reality. We
plot the scaling of the surface area versus population for US Urban Areas on
Figure~\ref{fig:scaling_area}. A fit assuming a power-law dependence gives an exponent

\graffito{All $\pm$ intervals are $95\%$ confidence intervals.}
\begin{equation}
    \boxed{\beta_A = 0.85 \pm 0.01\;(r^2 = 0.93)}
\end{equation}

A result which agrees with previous measurements made on morphologically defined
cities (see~\cite{Batty:2011} or Chapter~\ref{chap:scaling_introduction}). This means that the average surface occupied by each individual decreases with
city size. Or equivalently, that the population density increases with city size.
The prediction given by the naive model is therefore quantitatively -- and
worse, qualitatively -- different from the behaviour observed empirically.

\begin{figure}[!h]
    \centering
    \includegraphics[width=\textwidth]{gfx/chapter-scaling/scaling_area.pdf}
    \caption{{\bf Spatial footprint.} Scaling of the surface area of US urban areas with population size,
        and what would be expected with a naive model (blue solid line).
    A fit assuming a powerlaw dependence (dashed line) gives an exponent
    $\beta_A = 0.85 \pm 0.01\,(r^2 = 0.93)$.\label{fig:scaling_area}}
\end{figure}



\subsection{Total length of road}
\label{sub:total_length_of_road}

\paragraph{Naive model.} We would now like to estimate the total length $L_N$ of all the roads within a
city. If we consider that the network formed by streets is such that all the
nodes (intersections) are connected to their closest neighbour, the typical
length of a road segment is given by

\begin{equation}
    \ell_R \sim \sqrt{\frac{A}{N}}
\end{equation}

where $N$ is the number of intersections~\cite{Barthelemy:2008}. Previous studies of road networks in
different regions, and over extended time
periods~\cite{Strano:2012,Barthelemy:2013}, have shown that the number of
intersections is proportional to the population size. Therefore, the typical
length of a road segment (between two intersections) varies with the population
size $P$ as

\begin{equation} 
    \ell_R \sim \sqrt{\frac{A}{P}} 
    \label{eq:length_nodes}
\end{equation}

and the total length of the network $L_N \sim P\ell_R$ should then scale as

\begin{equation} 
    \frac{L_N}{\sqrt{A}} \sim \sqrt{P} 
\end{equation}

Using the naive scaling for the dependence of $A$ on population size given
previously in Eq.~\ref{eq:area_naive} we finally get 

\begin{equation} 
    L_N \sim P
\end{equation}

\paragraph{Reality.} Again, the naive argument does not compare well with
reality. We fit the data for US Urban Areas (see
Figure~\ref{fig:scaling_lanemiles}) assuming a powerlaw dependence and find an
exponent

\begin{equation}
    \boxed{\beta_R \sim 0.765 \pm 0.033\;(r^2 = 0.92)}
\end{equation}

Note that the relation between the length and the number of nodes given by
Eq.~\ref{eq:length_nodes}, as well as the relation between number of
intersections and population, have been verified independently in the
literature. The observed discrepancy on the exponent of $L_N$ is therefore
certainly due to the scaling of the surface area.

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{gfx/chapter-scaling/scaling_lanemiles.pdf}
    \caption{{\bf Length of roads.} Scaling of the total length of roads in US Urban Areas versu the
    total population. A fit assuming a powerlaw dependence (dashed grey line)
gives an exponent $\beta_R \sim 0.765 \pm 0.033$ ($r^2=0.92$). The behaviour is
qualitatively different from what would be expected with a naive model (solid
blue line).\label{fig:scaling_lanemiles}}
\end{figure}



\subsection{Total commuting distance}
\label{sec:total_length_driven}

The total commuting distance $L_{tot}$ is determined by two different
constraints. First the individual constraint: individuals make the decision
about where they are going to live and work; they have their own behaviour and
limitations. However, the individuals' choices are also limited by the city
structure itself, that is by the respective distributions of jobs and residences across the
city.



\subsubsection{Influence of the individual constraint} 

The first constraint on the commuting distance comes from individuals' limitations and
behaviour. We make here the simple assumption that individuals choose their
residence and work place such that their total commuting distance is fixed (or
at least, is smaller than a certain value) and equal on average to $\ell_C$. In that
case, we would simply have

\begin{equation} 
    \frac{L_{tot}}{P} \sim \text{constant} = \ell_c 
    \label{eq:assum}
\end{equation}

(by constant, we mean independent from the population size of the city). As
surprising as it may seem, the data show that $L_{tot}/P$ can indeed be considered
 independent from $P$ (with a value of approximately $23$ miles for
the US, see Figure~\ref{fig:LtotoverP}), in agreement with the individual
constraint assumption (Eq. \ref{eq:assum}). This finding is also in agreement
with the results drawn from census data in Germany by~\cite{Wilkerson:2014}.
This does not mean, of course, that the distance driven is the same for every
city. As one can see on Figure~\ref{fig:LtotoverP}, the fluctuations are quite
important between cities.  

\begin{figure}[!h]
    \includegraphics[width=1.0\textwidth]{gfx/chapter-scaling/figure_2.pdf}
    \caption{{\bf Commuting distance \& individual choice.} Constant daily driven distance per capita. (a) daily total driven
        distance per capita as a function of population for 441 urbanised area
        in the US in 2010. The data shown in the plot are compatible with a
    population-independent behaviour. (b) Histogram of the daily total driven
distance per capita for the same cities. The average daily driven distance is $23$ miles, and the standard deviation $7$ miles.}
\label{fig:LtotoverP} 
\end{figure}



\subsubsection{Influence of the city structure}
\label{sub:influence_of_the_city_structure}

The easiest way to understand the influence of the city constraints is to
consider two limiting cases: the totally centralised
(monocentric) city where everyone goes to work to a single center, and the
totally decentralised city where everyone goes to work to the nearest
location (see Figure~\ref{fig:monocentric_decentralised})~\cite{Samaniego:2008}.\\

\begin{figure}[!h]
    \centering
    \includegraphics[width=1\textwidth]{gfx/chapter-scaling/monocentric-decentralised.pdf}
    \caption{{\bf Limiting cases.} Representation of the monocentric city (left) and the totally
    decentralised city (right), two extreme models for the shape of mobility
patterns.\label{fig:monocentric_decentralised}}
\end{figure}

\paragraph{Monocentric.} If we first assume that the city is monocentric, individuals are all commuting
to the same center and the typical commuting distance $\ell^m_c$ is controlled
by the typical size of the city of order $\sqrt{A}$, so that

\begin{equation} 
    \frac{L_{tot}^{m}}{\sqrt{A}} \sim P 
\end{equation}

\paragraph{Decentralised.} On the other hand, if we assume that the city is completely decentralised, the
typical commuting distance is of order the nearest neighbour distance
$\sqrt{A}/\sqrt{P}$, and we obtain

\begin{equation} 
    \frac{L_{tot}^{d}}{\sqrt{A}} \sim \sqrt{P} 
\end{equation}

\paragraph{Reality. } The scaling of the total driven distance for Urban Areas
(morphological definition) is shown on
Figure~\ref{fig:scaling_Ltot_norm}, and the exponent sits between the ones of the
monocentric and decentralised cities

\begin{equation*}
    \boxed{\beta_L =  0.595 \pm 0.026\; (r^2 = 0.90)}
\end{equation*}


\begin{figure}
    \centering
    \includegraphics[width=0.9\textwidth]{gfx/chapter-scaling/scaling_commuting_norm.pdf}
    \caption{{\bf Commuting distance \& city structure.} Scaling of the total yearly commuted distance normalised by the
    city's surface area with population size for US Urban Areas. The blue lines
show the behaviours that would be expected for a monocentric and a totally
decentralised city. The dashed line represents the fit assuming a powerlaw
dependence, which yields an exponent $\beta =  0.595 \pm 0.026\, (r^2 =
0.90)$.\label{fig:scaling_Ltot_norm}}
    
\end{figure}

This comes as another evidence -- different from that presented in
Chapter~\ref{chap:monocentric_introduction} -- that cities do not have a
strictly monocentric structure. This result casts some further doubts about the
model by Bettencourt~\cite{Bettencourt:2013} which implicitely assumes that
cities are monocentric.\\

So far, so good. But how can we understand the non-trivial exponent that is observed? This is
where the limiting case are helpful: if the exponent sits between the ones that
would be obtained in a monocentric or decentralised city, surely, cities must
adopt an intermediate structure. 

\begin{figure}[!h]
    \centering
    \includegraphics[width=0.4\textwidth]{gfx/chapter-scaling/polycentric.pdf}
    \caption{{\bf Polycentric structure.} City with a polycentric structure, intermediate between the
    monocentric and totally decentralised situations. \label{fig:polycentric}}
\end{figure}

One candidate stands out: the polycentric city (see
Figure~\ref{fig:polycentric}). Let us thus consider a polycentric city with $k$
employment centers. The typical distance commuted by individuals is then given by

\begin{equation}
    \ell_c \sim \sqrt{\frac{A}{k}}
\end{equation}

So that

\begin{equation}
    \frac{L_{tot}}{\sqrt{A}} = \frac{P}{\sqrt{k}}
\end{equation}

Therefore if, as we showed in the previous part,  the number of centers
increases sublinearly with population, we would have a scaling of the form
$L_{tot}/\sqrt{A}\sim P^{\,\beta_L}$ where $\beta_L \in [1/2,1]$. The previous
expression is consistent with that of $A/\lambda^2$ and $L_{tot}/P$ if

\begin{equation} 
    \beta_L = 1-\frac{\beta_A}{2} 
    \label{eq:consis} 
\end{equation}

which is indeed what we observe empirically (up to error bars). We conclude from
this preliminary empirical analysis that, in order to compute the various
exponents, we need to better describe the structure of commuting patterns. In
other words, we need to find a description of cities that goes beyond the naive
monocentric or totally decentralized views, and which accounts for the observed
sub-linear scaling of the surface area $A$.



\begin{table*}[!h]
    \centering
\begin{tabular}{|c|c|c|l|}
\hline
Quantity & Naive exponent &  Measured value\\
\hline
$A $ & $1$ & $0.85\; (r^2=0.93)$\\
\hline
$L_N / \sqrt{A}$ & $0.5$ & $0.42\; (r^2=0.83)$\\
$L_N $ & $1$ & $0.89\;(r^2=0.77)$\\ 
\hline
$L_{tot} / \sqrt{A}$ &  $\left\{0.5,1\right\}$ & $0.60\; (r^2=0.90)$\\
$L_{tot} /P$ &  $1$ & $0.03\; (r^2=0.04)$\\
\hline
\end{tabular}
\caption{{\bf Naive exponents and measured values.} This table displays the value of the exponent governing the behavior with the population $P$ obtained by naive arguments and the value obtained from empirical data. The discrepancies reveal the failure of the naive scaling arguments and the necessity to go further and model mobility patterns.}
\label{table:naive}
\end{table*}



\section{Beyond naive scalings: modeling the mobility patterns}

The previous results, in particular the behaviour of the total commuting length
with population, hint at the necessity to better describe the structure of the
mobility patterns (Table~\ref{table:naive}). This is exactly what the model presented in the previous
chapter does. 

Using the relation that we derived for the number of centers, we will see
how we can understand the values of the exponents presented earlier in this
chapter. We will also see how the model allows us to understand the scaling of
other quantities, namely the total time spent in traffic and the total $CO_2$
emissions due to transportation.

\subsection{Area}

According to the model introduced in Chapter~\ref{chap:monocentric_model}, the number of centers is a function of population and the area

\begin{equation}
    k = F\left(A,P\right)
\end{equation}

and we need an additional equation in order to get a closed system. Here we
focus on the area and its evolution with the population size, which reflects the
growth process of the city. 

In the following, we will investigate two different
approaches. It is worth noting that both approaches give results in qualitative
agreement, showing that some stylized facts ---such as super- or sublinearity---
are very robust.\\ 

\paragraph{Fitting procedure.}

In the absence of knowledge of the processes responsible for urban sprawl, we
can assume that the area behaves as 

\begin{equation}
    A \sim P^{\,a}
    \label{eq:fit}
\end{equation}

where $a$ is the exponent to be determined by fitting data. The empirical
value for the exponent for the US data is $a\simeq 0.85$. Once this exponent is
given we can then compute the various exponent for the quantities of interest.
We get for the number of centers $k$

\begin{equation}
    k \sim P^{\frac{\mu + a/2}{\mu+1}}
\end{equation}

which is sublinear as long as $a<2$, in agreement with the empirical results for
US cities. As we will see, this approach yields the same qualitative behaviours
as those predicted with the method of the next section. In other words, even if
the main mechanism behind urban sprawl is not congestion, the conclusions of
this paper are not affected as long as the area scales \emph{sublinearly} with
population.\\


\paragraph{Coherent growth.}

Let us now assume that the scaling of $A$ with population is determined by the
number of activity centers and the constant commuting length of individuals.
This means that the growth of the area is controlled by the appearance of new
activity centers. 

If we assume that a city is organized around $k$ activity
centers and that the attraction basin of each of these centers are spatially
separated~\cite{Louf:2013_polycentric} (See on Figure~\ref{fig:polycentric}), we then have  $A \sim k\, A_1$ where $A_1$ is the
area of each subcenter's attraction basin. This area $A_1$ is related to the
average individual commuting distance by $\sqrt{A_1} \sim L_{tot} / P$, and we
obtain

\begin{equation}
    A \sim k\,  \left( \frac{L_{tot}}{P} \right)^2 = k\, \ell_c^2
    \label{eq:area_poly}
\end{equation}

This leads to expression for the number of centers

\begin{equation}
    k \sim P^{\frac{2 \mu}{2\mu+1}}
\end{equation}

which is always smaller than $1$, also in agreement with the empirical results
for US cities. We can now also compute the scaling of the surface area

\begin{equation}
    \frac{A}{\ell_c^2} \sim \left( \frac{P}{c} \right)^{\frac{2 \mu}{2\mu+1}}
\end{equation}

We further assume that $L_{tot} / P$ is a fraction of the longest possible
journey $\ell$ individuals can afford, that is to say 

\begin{equation}
    \ell_c \sim \ell
\end{equation}

It is important to note that if $\ell_c$ is independent from $\ell$, the
quantitative predictions of our model would still hold. 

The final expression for the area is then here given by

\begin{equation}
    \frac{A}{\ell^2} \sim \left( \frac{P}{c} \right)^{\,2\,\delta}
    \label{eq:area}
\end{equation}

where $\delta=\frac{\mu}{2\mu+1}$. The exponent $\delta$ is smaller than $1/2$
whatever $\mu\geq 0$, which implies that the surface area of cities increases
\emph{sublinearly} with population. In other words, the density of cities
\emph{increases}  with population. This prediction is verified with data about
land area of urbanized areas in the US (Figure~\ref{fig:scaling_area}). We find
$\beta_A = 0.85 \pm 0.01\;$ which is not too far from the
theoretical value $2\delta_{th} = 0.64 \pm 0.12$, equal to
$\alpha$ in this case.\\

Because the area of a city results from centuries of evolution, we do
not a priori expect our model -- where individual vehicles are assumed to be the
only vector of mobility -- to give a prediction valid for all countries and all
times. Nevertheless, these results give us reasons to believe that the spatial
structure of the journey-to-work commuting might be the dominant factor
in the dependence of land area on population. In the following, we will use the
above numerical value to compute other scaling exponents.


\subsection{Total commuting distance}

Using Eq.~\ref{eq:assum} and Eq.~\ref{eq:area} we are now able to compute $L_{tot}/\sqrt{A}$

\begin{equation}
    \frac{L_{tot}}{\sqrt{A}} = P\; \left(\frac{P}{c}\right)^{-\delta}
    \label{eq:travelled_length}
\end{equation}

We plot $L_{tot} / \sqrt{A}$ for urbanized areas in the US on
Figure~\ref{fig:scaling_Ltot_norm}, and one
can verify in Table~\ref{table:results} that the exponent predicted from the previously measured
value of $\alpha$ agrees well with the exponent measured on the data.


\subsection{Total length of roads}

If we use the previously derived expression for the area $A$, we find

\begin{equation}
    L_N \sim \ell \; \sqrt{P}\; \left(\frac{P}{c}\right)^{\,\delta}
\end{equation}

The quantity $\delta$ is less than $1/2$, which implies that $L_N$ scales
\emph{sublinearly} with the city's population size. In other words, larger
cities need less roads per capita than smaller ones: we recover the fact that
 the agglomeration of people in urban centers involves economies of scale for
infrastructures. 


\subsection{Total delay due to congestion}

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{gfx/chapter-scaling/scaling_delay.pdf}
    \caption{{\bf Congestion and delay.} Scaling of the total delay due to congestion of US urban areas with
    population size. A fit assuming a powerlaw dependence of the total delay on
population size yields an exponent $\beta_D = 1.270 \pm 0.067\;(r^2=0.97)$.\label{fig:scaling_delay}}
\end{figure}

Unfortunately, the agglomeration of activities in cities does not only generate economies.
Congestion, for instance, is a major diseconomy associated with the
concentration of people in a given area. A simple way to quantify the
impairement caused by traffic congestion is through the total delay it
generates. If we make the first order approximation that the average free-flow
speed $v$ is the same for everyone, the total delay due to congestion is given
--according to our model-- by

\begin{equation} 
    \delta \tau = \frac{1}{v} \sum_{i,j} d_{ij} \left(\frac{T_j}{c} \right)^\mu 
\end{equation}

If we assume that all the centers share the same number of commuters -- a
reasonable assumption within the model presented in
Chapter~\ref{chap:monocentric_model}~\cite{Louf:2013_polycentric} -- we obtain

\begin{equation} 
    \delta \tau \sim \frac{L_{tot}}{v} \left( \frac{P}{k}
\right)^{\mu} 
\end{equation} 

which, using the expressions for $L_{tot}$ and $A$
given in Eq.~\ref{eq:travelled_length} and Eq.~\ref{eq:area} respectively, gives

\begin{equation} 
    \delta \tau \sim \frac{\ell\; P}{v}\;\left(\frac{P}{c}\right)^{\delta} 
\end{equation}

The total commuting time corresponding to the same distance but without
congestion scales as $\tau_0\sim L_{tot}$ and thus less rapidly than the total
delay which scales \emph{super-linearly} with population (even when
polycentricity is taken into account). This means that, for the largest cities,
delays due to congestion actually dominate the time spent in traffic, and that
economical losses \emph{per capita} due to the time lost in congestion --and the
corresponding strain on people's life-- increase with the size of the city. 

The prediction $1+\delta = 1.32$ agrees well with the empirical measure (see
Table~\ref{table:results} and Figure~\ref{fig:scaling_delay})

\begin{equation}
    \boxed{\beta_D = 1.270 \pm 0.067\;(r^2 = 0.97)}
\end{equation}

\subsection{Transport related $CO_2$ emissions}

Another diseconomy associated with congestion is the quantity of $CO_2$ emitted
by cars and the gasoline consumed by motor vehicles. This amount not only
depends on the distance that has been driven, but also on the traffic during the
journey. It indeed turns out that for the same length driven, a car burns more
oil when the traffic is heavy than when the road is clear.  Within our model,
the presence of traffic is seen in the time spent to cover a given distance, and
we write that the quantity of $CO_2$ emitted by a vehicle is proportional to the
total time spent in traffic, leading to

\begin{equation}
    Q_{CO_2}  = q \sum_{i,j} d_{ij} \left[ 1+ \left( \frac{T_j}{c} \right)^\mu \right]
\end{equation}

where $q$ is the average quantity of $CO_2$ produced per unit time. In the
polycentric case with $k=k(P)$ subcenters, the typical trip length
$\overline{d_{ij}}$ is given by $\sqrt{A/k}$ and we obtain

\begin{equation}
    Q_{CO_2} = q\, \ell\, P \left[ 1 + \left(\frac{P}{c}\right)^{\delta} \right]
\end{equation}

The first term in brackets is a constant, and the quantity of $CO_2$ is thus
dominated by congestion effects at large populations

\begin{equation}
    Q_{CO_2} \sim q\; \ell\; P \left(\frac{P}{c}\right)^{\delta}
\end{equation}



and the total daily transport-related $CO_2$ emission per capita thus scales as 

\begin{equation}
    \frac{Q_{CO_2}}{P} \propto  q\ell \left(\frac{P}{c}\right)^{\delta}
\end{equation}

The quantity of $CO_2$ emitted per capita in cities thus increases with the size
of the city, a consequence of congestion. This prediction agrees with the
exponent we measure (Figurere~\ref{fig:scaling_co2}) on data gathered for US and OECD cities (see
Table~\ref{table:results})

\begin{equation}
    \boxed{\beta_C = 1.262 \pm 0.089\;(r^2=0.94)}
\end{equation}

\begin{figure}
    \includegraphics[width=0.9\linewidth]{gfx/chapter-scaling/scaling_co2.pdf}
    \caption{{\bf Congestion and $CO_2$ emissions.} Variation of $CO_2$
emissions due to transport with city size. In blue, excess $CO_2$ (in tons) due
to congestion, as given by the Urban Mobility Report (2010) for 101 metropolitan
areas in the US. In green, we show the estimated $CO_2$
emissions (in tons) due to transports, as given by the OECD for 268 metropolitan
areas in 28 different countries. The dashed yellow lines represent the least-square fit
assuming a power-law dependency with multiplicative noise, which gives
respectively $Q_{CO_2} \sim P^{1.262 \pm 0.089} (r^2=0.94)$ for the US data and
$Q_{CO_2} \sim P^{1.212 \pm 0.098} (r^2=0.83)$ for the OECD data.
\label{fig:scaling_co2}} 
\end{figure}



\section{Discussion}

\subsection{Travel-time budget and congestion}

The total commuting time $T$ can be written as

\begin{equation}
    T = \tau_0 + \delta\,\tau
\end{equation}

where $\tau_0 = L_{tot} / v \sim P$ is the free-flow commuting time and $\delta
\tau \sim P^{1+\delta}$ the excess commuting time computed above. The first
thing we notice when looking at the respective population dependence of both
quantities, is that, in large cities, the total commuting time is dominated by
the time spent in congestion. Indeed, we have

\begin{equation}
    \displaystyle \frac{T}{\delta_\tau} \xrightarrow[\:P \gg 1\:]{} 1
\end{equation}

Which agrees with one's (at least our) experience of driving in large cities.

The second remark is linked to a long-standing belief in the study of urban
systems that individuals possess a constant travel-time
budget~\cite{Zahavi:1974}. We can easily see, however, that this hypothesis is
wrong. Indeed, in the limit of large cities, the individual commuting time is
given by

\begin{equation}
    \frac{\delta_\tau}{P} \sim P^{\,\delta}
\end{equation}

In other words, the \emph{individual commuting time increases with the size of the
city}. Note that not only is this a consequence of the model, but also of the
data analysis (see Figure~\ref{fig:scaling_delay}). The constant travel-time
budget hypothesis is thus refuted. The reason for the discrepancy between
previous measures and our results comes from the fact that these studies
considered averages over large regions, rather than averages at the city
level.

\subsection{Newman \& Kenworthy}

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{gfx/chapter-scaling/newman_kenworthy.pdf}
    \caption{{\bf Newman \& Kenworthy.} Per capita $CO_2$ emissions versus the population density of cities
    belonging to OECD countries. The cities also present in the Newman \&
    Kenworthy dataset are represented in red. This curve casts serious doubt on
the fact that energy consumption is a simple funtion of
density.\label{fig:newman_kenworthy}}
\end{figure}

The consumption of gasoline is proportional to the emission of $CO_2$ and the time spent driving.
The total daily gasoline consumption is thus given by

\begin{equation} 
    Q_{gas} \sim q\; \ell\; P \left(\frac{P}{c}\right)^{\delta}
\end{equation}

where $q$ is the average quantity of gasoline needed per unit time. From this
expression, we see that the total daily gasoline consumption per capita scales
as

\begin{equation} 
    \frac{Q_{gas}}{P}\sim \ell\, \sqrt{\frac{P}{\rho}} = \ell
\sqrt{A} 
    \label{eq:nk_area}
\end{equation}

and is therefore not a simple function of population density, in contrast with
what was suggested by the seminal paper of Newman and
Kenworthy~\cite{Newman:1989}. We plot on Figure~\ref{fig:newman_kenworthy},  the average individual $CO_2$ emissions (used as a proxy for gasoline
consumption) as a function of the density for OECD cities. The points
corresponding to cities that were in the original study~\cite{Newman:1989} are
highlighted. The relation is a lot less clear than the one presented originally.  

We then plot the same quantity as a function of $\sqrt{A}$, the prediction given
by Eq.~\ref{eq:nk_area}, on Figure~\ref{fig:nk_model}. As one can see, the
prediction is far from perfectly followed. If anything, this figure, combined to
Figure~\ref{fig:newman_kenworthy} show that the debate, in the absence of a
clear-cut conclusion, is not over. At this stage, more data about gasoline
consumption -- preferably for cities belonging to the same system of cities --
is needed to explore this prediction.

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{gfx/chapter-scaling/nk_model.pdf}
    \caption{{\bf Newman \& Kenworthy revisited.} Per capita $CO_2$ emissions versus $\sqrt{A}$ for cities of
    countries that belong to the OECD. The dashed line represents the obtained
linear fit, as predicted by Eq.~\ref{eq:nk_area} ($r^2=0.55$). The agreement is
poor, which may be due to the fact that cities all belong to different systems
of cities (and thus have a different prefactor).\label{fig:nk_model}}
\end{figure}

\subsection{Monocentric versus polycentric}

Although polycentricity emerges naturally from our model as a result of
congestion, many circumstances can prevent or foster the appearance of new
activity centers in a city. There are many debates as to whether policies should
favour polycentric or monocentric developement of cities. Most of them are
based on ideologies and opinions about how cities should be, very few are based
on a quantitative understanding of the city as a complex system. Although this
only represents a small part of the debate, our model allows to quantify the
effect of polycentricity on the total delay due to congestion.

We can indeed compute the total delay due to congestion in the case of a
monocentric configuration. In this situation, all the population commutes to a
single destination $1$ and we have

\begin{equation}
    \delta \tau_{mono} = \frac{1}{v}\; \sum_i d_{i1} \left(\frac{P}{c} \right)^\mu = L_{tot} \left(\frac{P}{c} \right)^\mu
\end{equation}

It follows, using the expression given above for $L_{tot}$

\begin{equation}
    \delta\tau_{mono} = \frac{\ell}{v}\; P^{1+\mu}
\end{equation}

From the fact that $1+\mu > 1+\frac{\mu}{2\mu+1}$, we indeed find that the total
delay due to congestion is worse for monocentric cities than it is for
polycentric cities with the same population, which agrees with the usual
intuition. More precisely the ratio of delays is given by

\begin{equation}
    \frac{\delta\tau_{mono}}{\delta\tau_{poly}}\sim
    \left(\frac{P}{c}\right)^{\,\beta}
\end{equation}

where the exponent is of order $\beta \approx 0.57\;$. Therefore, even though
diseconomies associated with polycentric cities scale superlinearly with
population, it would be even worse if we did not let cities evolve from the
monocentric situation. The same reasoning applies to the consumption of gasoline and
the $CO_2$ emissions. 

This suggests that, everything else being equal,
polycentricity should be favoured for quality of life and environmental reasons.

\begin{table*}[!h]
\begin{tabular}{|c|c|c|c|}
\hline
Quantity & Theoretical expression & Predicted exponent & Measured value\\
  $\;\;$  & ($\delta=\alpha/\alpha+1$) & & \\ \hline
$L_{tot}$ & $P$ & $1$ & $1.03 \pm 0.03\;(r^2=0.95)$\\ 
$A / \ell^2$ & $\left( \frac{P}{c} \right)^{\,2\,\delta}$ & $2 \delta = 0.78 \pm 0.20$ & $0.853 \pm 0.011\; (r^2=0.93)$\\
$L_N / \ell$ & $\sqrt{P}\; \left(\frac{P}{c}\right)^{\,\delta}$ & $\frac{1}{2} + \delta = 0.89 \pm 0.10 $ & $0.765 \pm 0.033\; (r^2=0.92)$\\
$\delta \tau / \tau$ & $P\; \left( \frac{P}{c} \right)^{\, \delta}$ & $1 +
\delta = 1.39 \pm 0.10$ & $1.270 \pm 0.067\; (r^2=0.97)$\\
$Q_{gas,CO_2}/\ell$  & $P\left( \frac{P}{c}\right)^{\delta}$ & $1+\delta=1.39 \pm 0.10$ & $1.262 \pm 0.089\; (r^2=0.94)$\\
& & & $1.212 \pm 0.098\, (r^2=0.83)$\\
\hline \hline
$L_N / \sqrt{A}$ & $\sqrt{P}$ & $0.5$ & $0.42 \pm 0.02\;(r^2=0.83)$\\
$L_{tot} / \sqrt{A}$ &  $P\;
\left(\frac{P}{c}\right)^{-\delta}$ & $1 - \delta = 0.61 \pm 0.10$ & $0.595 \pm 0.026\; (r^2=0.90)$\\
\hline
\end{tabular}
\caption{{\bf Summary of the scaling exponents.} This table displays the predicted theoretical behavior and
  the empirical observations versus the population size $P$ for
  different quantities: $L_{tot}$ is the daily total driven distance,
  $A$ is the area of the city, $L_{N}$ is the total length of the road
  network, $\delta\tau$ is the daily total delay due to congestion,
  $Q_{gas}$ is the yearly total consumption of gasoline and $Q_{CO_2}$
  is the total $CO_2$ emissions emitted yearly due to
  transportation. In the third column, we show the predicted values of
  the exponent of $P$ using the value of $\alpha$ measured on US
  employment data, and in the fourth column, the value of the
  exponents directly measured on data about US and OECD cities. The
  measured values are in good agreement with the prediction. In
  particular, the exponents for $L_N$ and $\delta \tau$ are consistent
  with our prediction that their difference should be $1/2$.}
\label{table:results}
\end{table*}


\subsection{Outlook}

The superlinear increase of congestion delay with population, and thereby of
gasoline consumption and of $CO_2$ emissions, has terrible consequences on the
economy, the environment, health and well-being. The outlook is nothing short of
grim in our ever-urbanising world. As the proportion of human beings living in
cities dramatically increases -- the UN expects the world population to be $67\%$
urban in 2050 -- wages are likely to \graffito{Estimates are given in the United
Nations' 2011 World Urban Propects.}
increase~\cite{Bettencourt:2007} but not enough to compensate for the negative
effects of congestion. As a result, if the individual car stays the dominant
transportation mode, cities will put more strain on people's life, while acting
as catalysts for the production of $CO_2$ greenhouse gas, which is responsible for an
overall increase of the planet's temperature~\cite{Oreskes:2004}. 

It is currently believed that advantages associated with living in a large city
outweigh the costs. Our results reveal however the existence of very rapidly
growing problems such as congestion and $CO_2$ emissions, which inevitably begs
the question of the sustainability of large cities. It might be time to cut down
considerably the use of individual vehicles, or to consider the possibility of
living in smaller or medium sized cities: the infrastructure costs ($L_N$) may
be larger, but the impact on the environment ($CO_2$ emissions) and on the
well-being of people (delays in congestion) would be beneficial.\\

The most striking fact about the above results is that despite the apparence of
complexity that is conveyed by cities, most of their structure can be explained
by the very simple and universal desire for the best achievable balance between
income and commuting costs. Our model unifies mobility patterns, spatial
structure of cities and allometric scalings in a framework that can be built
upon. 
